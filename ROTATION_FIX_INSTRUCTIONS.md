# ?? ??????????: ??????? ??? ????? ????? ?????????, ? ????? ???

## ?? ????: `OpenGL/src/core/main.cpp`

## ?? ??????: ???????? 700-706

### ? ????? ? ???????:

```cpp
// Creating view matrix with camera position and rotation
glm::mat4 view = glm::mat4(1.0f);
view = glm::translate(view, glm::vec3(-camera_position.x, -camera_position.y, 0.0f));
view = glm::rotate(view, glm::radians(camera_rotation), glm::vec3(0.0f, 0.0f, 1.0f));

// Combine projection and view
glm::mat4 viewProjection = projection * view;
```

### ? ???????? ??:

```cpp
// ============================================================================
// Two separate view matrices for different rendering layers
// ============================================================================

// VIEW 1: World objects (track, vehicles) - NO rotation
glm::mat4 view_world = glm::mat4(1.0f);
view_world = glm::translate(view_world, glm::vec3(-camera_position.x, -camera_position.y, 0.0f));
glm::mat4 viewProjection_world = projection * view_world;

// VIEW 2: Grid - WITH rotation for visual effect
glm::mat4 view_grid = glm::mat4(1.0f);
view_grid = glm::translate(view_grid, glm::vec3(-camera_position.x, -camera_position.y, 0.0f));
view_grid = glm::rotate(view_grid, glm::radians(camera_rotation), glm::vec3(0.0f, 0.0f, 1.0f));
glm::mat4 viewProjection_grid = projection * view_grid;
```

---

## ?? ???????? ????????????? ??????:

### 1. Grid rendering (?????? ~722) - ???????????? viewProjection_grid

???? (?????? renderGrid):
```cpp
glm::mat4 viewProjection = projection * view;  // ? rotation
```

??? ??????????! renderGrid ???????? camera_rotation ? ??????? ???? view_grid ??????.

### 2. Track rendering (?????? ~727) - ???????????? viewProjection_world

?????:
```cpp
glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(viewProjection));
TrackRenderer::renderCachedTrack(shader_program);
```

???????? ??:
```cpp
glUniformMatrix4fv(projLoc, 1, GL_FALSE, glm::value_ptr(viewProjection_world));
TrackRenderer::renderCachedTrack(shader_program);
```

### 3. Vehicle rendering (?????? ~733) - ???????????? viewProjection_world

?????:
```cpp
renderAllVehicles(shader_program, vao, vbo, viewProjection, camera_position, camera_zoom);
```

???????? ??:
```cpp
renderAllVehicles(shader_program, vao, vbo, viewProjection_world, camera_position, camera_zoom);
```

---

## ? ????? ?????????:

- ? ????? ????? ????????? ??? R + ??????? (viewProjection_grid)
- ? ???? ? ?????? ?? ????? ????????? (viewProjection_world)
- ? ??? ????? ????????? ? ???????? ?????????

---

## ?? ????????????:

1. ?????????????? (`Ctrl+Shift+B`)
2. ????????? ?????????
3. ????????? ????
4. ?????? **R** ? ?????? **??????? ?????/??????**
5. **?????????:**
   - ????? ????????? ?
   - ???? ???????? ??????????? ?
   - ?????? ???????? ???????????? ?

# ? ??????????: Config ???????? + Best Lap ????? 2+ ??????

## ????????:

### 1. ? Config LAP_START_NUMBER = 1, ?? ??? ????????? Lap 0
**???????:** ??????????? ? Config.h ???? ??????????

### 2. ? ????? ??????? ????? Best Lap = Last Lap (??????????)
**???????:** "??????" ???? ?? ????? ?????? ????? ???? ?????? ???? ??????????? ????

---

## ???????:

### 1. ? ????????? Config.h ? ??????????? ?????????????

**???? (???????????? ???????????):**
```cpp
// 0 = ????? ??????? ??????????? ?????? ?????????? ???? 2
// 1 = ????? ??????? ??????????? ?????????? ???? 1
static constexpr int LAP_START_NUMBER = 0;
```

**????? (?????????? ??????????? + ???????? ????????):**
```cpp
// 0 = ????? ??????? ??????????? ?????? ?????? ???? Lap 0 ? ????????? ? ?????????? Lap 1
// 1 = ????? ??????? ??????????? ?????? ?????? ???? Lap 1 ? ????????? ? ?????????? Lap 2
static constexpr int LAP_START_NUMBER = 1;  // ?????????????: 1 (??? ? ???????? ??????)
```

### 2. ? Best Lap ???????????? ?????? ??? 2+ ??????????? ??????

**????????? ? RaceManager.cpp:**

**A. GetVehicleBestLapTime() - ????????? ????????:**
```cpp
float RaceManager::GetVehicleBestLapTime(int32_t vehicleID) const
{
    auto it = m_vehicleTimings.find(vehicleID);
    if (it != m_vehicleTimings.end())
    {
        // ? Best lap ????? ????? ?????? ????? ???? ??????? 2 ??????????? ?????
        if (it->second.completedLaps < 2)
            return -1.0f;  // ?????????? ????????
        
        return it->second.bestLapTime;
    }
    
    return -1.0f;
}
```

**B. GetStandingsInternal() - ?? ?? ????? ??? ??????? ???????????:**
```cpp
// ? Best lap ????? ????? ?????? ????? ???? ??????? 2 ??????????? ?????
standing.bestLapTime = (timing.completedLaps >= 2) ? timing.bestLapTime : -1.0f;
```

**C. GetStandingsInternal() - ????????? fallback:**
```cpp
else
{
    standing.bestLapTime = -1.0f;  // ????: 999999.0f ?
}
```

---

## ?????????:

### ????? LAP_START_NUMBER = 1 (??? ? ???????? ??????):

**??? ??????:**
```
Console:
[RACE MANAGER] Vehicle #1 crossed start/finish line, starting Lap 1 (offset: 0.016s)

UI Lap Timer:
LAPTIME:      00:05.123
LAST LAP:     --:--:---  ? ????????
BEST LAP:     --:--:---  ? ????????
DELTA:        00.000
```

**????? ?????????? Lap 1:**
```
Console:
[RACE MANAGER] Vehicle #1 completed Lap 1 in 83.456 seconds | Total completed laps: 1
[RACE MANAGER] Vehicle #1 crossed start/finish line, starting Lap 2 (offset: 0.012s)

UI Lap Timer:
LAPTIME:      00:15.234
LAST LAP:     01:23.456  ? ?????????? ???????????? ????
BEST LAP:     --:--:---  ? ???????? (??? ? ??? ??????????)
DELTA:        00.000
```

**????? ?????????? Lap 2:**
```
Console:
[RACE MANAGER] Vehicle #1 completed Lap 2 in 81.234 seconds | Total completed laps: 2
[RACE MANAGER] Vehicle #1 crossed start/finish line, starting Lap 3 (offset: 0.014s)

UI Lap Timer:
LAPTIME:      00:08.123
LAST LAP:     01:21.234  ? ?????????? ????
BEST LAP:     01:21.234  ? ?????? ?? ???? (????????!)
DELTA:        -13.111    ? ??????? (??????? best)
```

**????? ?????????? Lap 3 (?????????):**
```
Console:
[RACE MANAGER] Vehicle #1 completed Lap 3 in 85.678 seconds | Total completed laps: 3

UI Lap Timer:
LAPTIME:      00:02.345
LAST LAP:     01:25.678  ? Lap 3
BEST LAP:     01:21.234  ? Lap 2 (?????? ????????)
DELTA:        +04.444    ? ??????? (????????? best)
```

---

### ????? LAP_START_NUMBER = 0 (???????????):

**??? ??????:**
```
Console:
[RACE MANAGER] Vehicle #1 crossed start/finish line, starting Lap 0 (offset: 0.016s)

UI Lap Timer:
LAPTIME:      00:05.123
LAST LAP:     --:--:---
BEST LAP:     --:--:---
```

**????? ?????????? Lap 0:**
```
Console:
[RACE MANAGER] Vehicle #1 completed Lap 0 in 83.456 seconds | Total completed laps: 1
[RACE MANAGER] Vehicle #1 crossed start/finish line, starting Lap 1 (offset: 0.012s)

UI Lap Timer:
LAPTIME:      00:15.234
LAST LAP:     01:23.456  ? Lap 0
BEST LAP:     --:--:---  ? ????????
```

**????? ?????????? Lap 1:**
```
Console:
[RACE MANAGER] Vehicle #1 completed Lap 1 in 81.234 seconds | Total completed laps: 2
[RACE MANAGER] Vehicle #1 crossed start/finish line, starting Lap 2 (offset: 0.014s)

UI Lap Timer:
LAPTIME:      00:08.123
LAST LAP:     01:21.234  ? Lap 1
BEST LAP:     01:21.234  ? ?????? ?? ???? (????????!)
```

---

## ?????? ??????:

### completedLaps ? ???????????:

| completedLaps | LAST LAP | BEST LAP | ?????? |
|---------------|----------|----------|--------|
| 0 | `--:--:---` | `--:--:---` | ??? ??????????? ?????? |
| 1 | `01:23.456` | `--:--:---` | ???? ???? ????, ?? ??? ? ??? ?????????? |
| 2+ | `01:21.234` | `01:20.789` | ???? ????????? + ?????? ?? ???? |

### ?????? ??? ??????????:

**UX ???????????:**
- "Best Lap" ????????????? **?????** ?? ?????????? ?????????
- ???? ???? ?????? ???? ???? - ??? ?????? "lap", ? ?? "best"
- ????? ??????? ????? ????? ??????????: "???? ????? ??? ????"

**???????? ?????:**
- ? F1/MotoGP best lap ???????????? ????? ???? ??????? 2 ?????
- ????? ?????????? ?????? "Last Lap"

---

## ????????????:

### ???????? 1: ?????? ? LAP_START_NUMBER = 1
```
1. ??????? ?????? (T key)
2. ?????? ?????????? ????? ? "starting Lap 1"
3. UI ??????????: LAST=????????, BEST=???????? ?
4. ????????? ???? ? "completed Lap 1"
5. UI ??????????: LAST=01:23.456, BEST=???????? ?
6. ????????? ?????? ???? ? "completed Lap 2"
7. UI ??????????: LAST=01:21.234, BEST=01:21.234 ?
```

### ???????? 2: ?????? ? LAP_START_NUMBER = 0
```
1. ??????? ?????? (T key)
2. ?????? ?????????? ????? ? "starting Lap 0"
3. UI ??????????: LAST=????????, BEST=???????? ?
4. ????????? ???? ? "completed Lap 0"
5. UI ??????????: LAST=01:23.456, BEST=???????? ?
6. ????????? ?????? ???? ? "completed Lap 1"
7. UI ??????????: LAST=01:21.234, BEST=01:21.234 ?
```

---

## ???????? ??????: 2

### 1. OpenGL\src\Config.h
- ?????????? ??????????? ??? LAP_START_NUMBER
- ???????? ???????? ? 0 ?? 1 (?????????????)

### 2. OpenGL\src\racing\RaceManager.cpp
- GetVehicleBestLapTime(): ???????? completedLaps >= 2
- GetStandingsInternal(): ???????? completedLaps >= 2
- GetStandingsInternal(): fallback -1.0f ?????? 999999.0f

---

## ? ?????????:

- [x] ?????????? ???????
- [x] LAP_START_NUMBER = 1 ???????? (??????? ?????????? "Lap 1, 2, 3...")
- [x] Best Lap ???????????? ?????? ??? 2+ ??????
- [x] ????? 1 ?????: Last = ?????, Best = ????????
- [x] ????? 2 ??????: Last = ?????, Best = ??????
- [x] UI ?????????? ???????? ??? -1.0f

---

## ?? ??????!

?????? ??????? ???????? ???????:
- ? Config LAP_START_NUMBER ??????????? (Lap 1, 2, 3...)
- ? Best Lap ?????????? ?????? ????? ???? ? ??? ??????????
- ? ???????????????? UX ??? ? ????????? ??????

**?????????? ???????, ?????? ? ?????????????!** ??
